<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Manage Lists - SFM</title>

<!-- PWA / manifest & icons -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#2285ff">

<!-- icons -->
<link rel="icon" href="icon/icon-192.png" sizes="192x192">
<link rel="apple-touch-icon" href="icon/icon-512.png">

<!-- iOS -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="mobile-web-app-capable" content="yes">

<style>

/* Prevent input zoom on Android keyboard */
input, select, textarea {
  font-size: 16px; /* at least 16px stops auto zoom */
}

/* ---------- Matching Styles with index.html ---------- */
body {
  font-family: "Segoe UI", Arial, sans-serif;
  background: linear-gradient(135deg,#c6fbfb, #c3fceb );
  margin: 0;
  padding: 0;
  color: #0e0d0d;
}
header {
  text-align: center;
  padding: 60px 0;
  background: linear-gradient(135deg, #a7fbfb 10%, #d8fa5c 90%);
  font-size: 44px;
  font-weight: bold;
  color: #000;
  box-shadow: 0 4px 18px rgba(3, 93, 93, 0.986);
}
.container {
  max-width: 880px;
  margin: 50px auto;
  background: #fefff7;
  padding: 40px 30px;
  border-radius: 28px;
  box-shadow: 0 17px 24px rgba(7, 7, 7, 0.986);
  text-align: center;
}
h2 {
  color: #0a0f4a;
  font-size: 25px;
  margin-bottom: 30px;
  border-bottom: 3px solid #5d63ae;
  padding-bottom: 10px;
}
table {
  width: 100%;
  border-collapse: collapse;
  margin: 25px 0;
  background: linear-gradient(125deg, #e4fdfc, #ecfcc2);
  box-shadow: 0 19px 20px rgba(1, 1, 1, 0.99);
  border-radius: 16px;
  overflow: hidden;
}
th {
  background: #9affff;
  font-size: 24px;
  padding: 14px;
  border-bottom: 2px solid #000;
}
td {
  padding: 20px;
}
input[type="text"] {
  width: 60%;
  padding: 12px;
  font-size: 18px;
  border: 2px solid #0b0171;
  border-radius: 10px;
  box-shadow: 0 5px 8px rgba(0,0,0,0.5);
}
.btn {
  display: inline-block;
  margin: 20px;
  padding: 14px 32px;
  font-size: 22px;
  border-radius: 10px;
  box-shadow: 0 13px 22px rgb(5,5,5);
  cursor: pointer;
  transition: 0.3s;
}
.set-btn {
  background: linear-gradient(135deg, #b9faff, #f1ffaf);
  color: #000;
}
.back-btn {
  background: linear-gradient(135deg, #838282fa, #070707);
  color: #fff;
}
.btn:hover { transform: translateY(-4px); }
.note {
  font-size: 18px;
  color: #000;
  margin-top: 15px;
  font-style: italic;
}
</style>
</head>

<body>
<header>Managing Subject & Faculty feilds</header>

<div class="container">
  <h2><i>Enter Subject and Faculty Names  </br> (This data will be saved & displayed in subject and faculty feilds of feedback form)</i></h2>

  <!-- Subject Table -->
  <table id="subjectTable">
    <thead><tr><th>Subject Names</th></tr></thead>
    <tbody></tbody>
  </table>

  <!-- Faculty Table -->
  <table id="facultyTable">
    <thead><tr><th>Faculty Names</th></tr></thead>
    <tbody></tbody>
  </table>

  <button id="setListsBtn" class="btn set-btn">save feilds ‚úÖ</button>
  <button id="backBtn" class="btn back-btn">Back to Admin üîô</button>

  <p class="note">Fill any number of rows (minimum one). Click ‚ÄúSave feilds‚Äù to set the feilds in Feedback Form.</p>
</div>

<!-- Firebase Scripts -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-analytics.js";

/* === SAME FIREBASE CONFIG FROM index.html === */
const firebaseConfig = {
  apiKey: "AIzaSyCWAu5JS9tMSCVJI0bjHRoXUkxBRcTy6oI",
  authDomain: "sfm-feedback-system.firebaseapp.com",
  projectId: "sfm-feedback-system",
  storageBucket: "sfm-feedback-system.firebasestorage.app",
  messagingSenderId: "803809181569",
  appId: "1:803809181569:web:5514c62285e2bb5af6b280",
  measurementId: "G-D0FG04711S"
};
const app = initializeApp(firebaseConfig);
getAnalytics(app);
const db = getFirestore(app);

/* -------- Create rows (9) for each table -------- */
function createRows() {
  const subjBody = document.querySelector("#subjectTable tbody");
  const facBody = document.querySelector("#facultyTable tbody");
  subjBody.innerHTML = "";
  facBody.innerHTML = "";
  // --- Replace the innerHTML lines inside your createRows() loop with this DOM-based code ---
for (let i = 0; i < 9; i++) {
  // Subject row
  const sTr = document.createElement('tr');
  const sTd = document.createElement('td');
  const sInput = document.createElement('input');
  sInput.type = 'text';
  sInput.id = 'subj' + i;
  sInput.placeholder = 'Subject ' + (i + 1);
  sInput.className = 'list-input'; // optional ‚Äî keep styling consistent
  sTd.appendChild(sInput);
  sTr.appendChild(sTd);
  subjBody.appendChild(sTr);

  // Faculty row
  const fTr = document.createElement('tr');
  const fTd = document.createElement('td');
  const fInput = document.createElement('input');
  fInput.type = 'text';
  fInput.id = 'fac' + i;
  fInput.placeholder = 'Faculty ' + (i + 1);
  fInput.className = 'list-input'; // optional
  fTd.appendChild(fInput);
  fTr.appendChild(fTd);
  facBody.appendChild(fTr);
}
}

/* -------- Load existing lists -------- */
async function loadExistingLists() {
  const docRef = doc(db, "lists", "data");
  const snap = await getDoc(docRef);
  if (snap.exists()) {
    const data = snap.data();
    const subs = data.subjects || [];
    const facs = data.faculty || [];
    subs.forEach((s, i) => {
      const el = document.getElementById("subj" + i);
      if (el) el.value = s;
    });
    facs.forEach((f, i) => {
      const el = document.getElementById("fac" + i);
      if (el) el.value = f;
    });
  }
}

/* -------- Save lists to Firestore -------- */
async function saveLists() {
  const subjects = [];
  const faculty = [];
  for (let i = 0; i < 9; i++) {
    const s = document.getElementById("subj" + i).value.trim();
    const f = document.getElementById("fac" + i).value.trim();
    if (s) subjects.push(s);
    if (f) faculty.push(f);
  }

  if (subjects.length === 0 && faculty.length === 0) {
    alert("Please enter at least one subject or faculty name!");
    return;
  }

  try {
    await setDoc(doc(db, "lists", "data"), { subjects, faculty });
    alert("‚úÖ Lists successfully saved!");
  } catch (e) {
    console.error("Error saving lists: ", e);
    alert("‚ùå Failed to save lists. Check console for details.");
  }
}

/* -------- Event Listeners -------- */
document.addEventListener("DOMContentLoaded", () => {
  createRows();
  loadExistingLists();
  document.getElementById("setListsBtn").addEventListener("click", saveLists);
  document.getElementById("backBtn").addEventListener("click", () => {
    window.location.href = "admin.html";
  });
});

// Register Service Worker
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('service-worker.js')
        .then(() => console.log('Service Worker registered successfully.'))
        .catch(err => console.log('Service Worker registration failed:', err));
    });
  }

</script>
</body>
</html>